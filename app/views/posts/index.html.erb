
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Moments // Tell your story in pictures.</title>
  </head>
  <body>
    <h1>MOMENTS</h1>
    </br>
    </br>
    <%= link_to new_post_path do %>
      NEW MOMENT
    <% end %>
    <% @posts.reverse.each do |post| %>
      <div id="post_image">
        <%= image_tag(post.moment.url(:medium)) %>
      </div>
      <%= post.created_at.strftime("Posted on %a, %d %b %Y") %>
      <div id="post_caption">
        <%= post.caption %>
      </div>
      <div id="post_likes">
        ❤️ <%= post.likes.count %>
      </div>
      </br>
      <%= link_to 'LIKE', post_likes_path(post), method: :post %>
      </br>
      <%= link_to 'EDIT CAPTION', edit_post_path(post.id) %>
      <%= link_to 'DELETE MOMENT', post_path(post), method: :delete %>
      </br>
      </br>
      <% post.comments.reverse.each do |comment| %>
        <div id="all_comments">
          <p> COMMENTS </p>
          <%= comment.body %> </br>
          <%= comment.created_at.strftime("Commented on %a, %d %b %Y") %>
          </br>
          <%= link_to 'DELETE COMMENT', post_comment_path(post, comment), method: :delete %>
          </br>
        </div>
      <% end %>
      <div id="comment_form">
        <%= form_with(model: [ post, post.comments.build], local: true) do |form| %>
          <%= form.text_area :body, cols: "20", rows: "5" %>
          <br>
          <%=form.submit "COMMENT"%>
        <% end %>
      </div>
      </br>
      </br>
    <% end %>
  </body>
</html>
